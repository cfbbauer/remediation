param (
    [string]$logfolder
)

if (!$logfolder) {
    $logfolder = "c:\Temp"
    Write-Host "`n`nParameter is null or empty.  Using c:\Temp directory for logfile.`n"

    if (!(Test-Path -Path $logfolder)) {
        New-Item -ItemType Directory -Path $logfolder
        Write-Host "Folder '$logfolder' created successfully.`n"
        } else {
        Write-Host "Folder '$logfolder' already exists.`n"
    }
}

$logfile = "$logfolder\remediate-CV-2024-7264-logfile.log"

Start-Transcript -Path $logfile

Write-Host "`n   Script is being run as the user shown below"
whoami /user

Write-Host "`n   Starting to remediate CVE-2024-7264 on computer $env:computername `n"


$startingPath = "c:\Program Files"
Write-Host "Starting recursive search in folder: $startingPath `n"

$folderName = "Salesforce"
$folderPath = Get-ChildItem -Force -Path $startingPath -Directory -Filter $folderName -Recurse -ErrorAction SilentlyContinue
$completePath = $($folderPath.FullName)

if ($folderPath) {
    Write-Host "Folder found: $completePath"
#    Remove-Item -Path $completePath -Recurse -Force
#    if ($?) { Write-host "Folder removed: $completePath`n"
#    } else {
#    Write-Host "Failure to delete directory: $completePath`n"
#    }
} else {
    Write-Host "Folder '$folderName' not found.`n"
}


$folderName = "Simba DocumentDB ODBC Driver"
$folderPath = Get-ChildItem -Force -Path $startingPath -Directory -Filter $folderName -Recurse -ErrorAction SilentlyContinue
$completePath = $($folderPath.FullName)

if ($folderPath) {
    Write-Host "Folder found: $completePath"
 #   Remove-Item -Path $completePath -Recurse -Force
 #   if ($?) { Write-host "Folder removed: $completePath`n"
 #   } else {
 #   Write-Host "Failure to delete directory: $completePath`n"
 #   }
} else {
    Write-Host "Folder '$folderName' not found.`n"
}


$folderName = "Simba Google BigQuery ODBC Driver"
$folderPath = Get-ChildItem -Force -Path $startingPath -Directory -Filter $folderName -Recurse -ErrorAction SilentlyContinue
$completePath = $($folderPath.FullName)

if ($folderPath) {
    Write-Host "Folder found: $completePath"
#    Remove-Item -Path $completePath -Recurse -Force
#        if ($?) { Write-host "Folder removed: $completePath`n"
#    } else {
#    Write-Host "Failure to delete directory: $completePath`n"
#    }
} else {
    Write-Host "Folder '$folderName' not found.`n"
}


$folderName = "Simba Hive ODBC Driver"
$folderPath = Get-ChildItem -Force -Path $startingPath -Directory -Filter $folderName -Recurse -ErrorAction SilentlyContinue
$completePath = $($folderPath.FullName)

if ($folderPath) {
    Write-Host "Folder found: $completePath"
 #   Remove-Item -Path $completePath -Recurse -Force
 #   if ($?) { Write-host "Folder removed: $completePath`n"
 #   } else {
 #   Write-Host "Failure to delete directory: $completePath`n"
 #   }
} else {
    Write-Host "Folder '$folderName' not found.`n"
}


$folderName = "Simba Impala ODBC Driver"
$folderPath = Get-ChildItem -Force -Path $startingPath -Directory -Filter $folderName -Recurse -ErrorAction SilentlyContinue
$completePath = $($folderPath.FullName)

if ($folderPath) {
    Write-Host "Folder found: $completePath"
#    Remove-Item -Path $completePath -Recurse -Force
#    if ($?) { Write-host "Folder removed: $completePath`n"
#    } else {
#    Write-Host "Failure to delete directory: $completePath`n"
#    }
} else {
    Write-Host "Folder '$folderName' not found.`n"
}


$folderName = "Simba QuickBooks ODBC Driver"
$folderPath = Get-ChildItem -Force -Path $startingPath -Directory -Filter $folderName -Recurse -ErrorAction SilentlyContinue
$completePath = $($folderPath.FullName)

if ($folderPath) {
    Write-Host "Folder found: $completePath"
#    Remove-Item -Path $completePath -Recurse -Force
#    if ($?) { Write-host "Folder removed: $completePath`n"
#    } else {
#    Write-Host "Failure to delete directory: $completePath`n"
#    }
} else {
    Write-Host "Folder '$folderName' not found.`n"
}


$folderName = "Simba Spark ODBC Driver"
$folderPath = Get-ChildItem -Force -Path $startingPath -Directory -Filter $folderName -Recurse -ErrorAction SilentlyContinue
$completePath = $($folderPath.FullName)

if ($folderPath) {
    Write-Host "Folder found: $completePath"
#    Remove-Item -Path $completePath -Recurse -Force
#    if ($?) { Write-host "Folder removed: $completePath`n"
#    } else {
#    Write-Host "Failure to delete directory: $completePath`n"
#    }
} else {
    Write-Host "Folder '$folderName' not found.`n"
}

Write-Host "Script ending."
Stop-Transcript